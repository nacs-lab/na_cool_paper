%% Raman Cooling
state = NaRamanState(s);
% The following Pulsed cooling no-op
state.PulseOPF1 = 0.32;
state.TPulseOP = 40e-6;

% NaPulsedCool(T, Det, F1Vert, F2Counter, RamanF1, RamanF2, OPF2)
% NCoolCycles = 20;
NaAxial0 = -18.506e6;
NaAxialF = 67.5e3;

NaAxial8 = NaAxial0 + NaAxialF * 8;
NaAxial7 = NaAxial0 + NaAxialF * 7;
NaAxial6 = NaAxial0 + NaAxialF * 6;
NaAxial5 = NaAxial0 + NaAxialF * 5;
NaAxial4 = NaAxial0 + NaAxialF * 4;
NaAxial3 = NaAxial0 + NaAxialF * 3;
NaAxial2 = NaAxial0 + NaAxialF * 2;
NaAxial1 = NaAxial0 + NaAxialF;
NaAxial1_2 = NaAxial0 + 77e3;

NaCools1 = {NaPulsedCool(25e-6, -17.6375e6, 1, 1, 0.0, 0.05, 0.21, 1.0, 0.0), ...
            NaPulsedCool(25e-6, -18.03e6, 1, 1, 0.0, 0.05, 0.23, 1.0, 0.0), ...
            NaPulsedCool(25e-6, -17.2825e6, 0, 1, 0.0, 0.05, 0.21, 0.22, 0.0), ...
            NaPulsedCool(21e-6, -17.875e6, 0, 1, 0.0, 0.05, 0.23, 0.22, 0.0)};
NaCools1 = repmat(NaCools1, 1, 5);
% Axial 8+7, Radial2 2+1, Radial3 2+1
NaCools2 = {NaPulsedCool(80e-6, NaAxial8, 1, 0, 0.4, 0.14, 0.21), ...
            NaPulsedCool(80e-6, NaAxial7, 1, 0, 0.4, 0.14, 0.21), ...
            NaPulsedCool(25e-6, -17.6375e6, 1, 1, 0.0, 0.05, 0.21, 1.0, 0.0), ...
            NaPulsedCool(25e-6, -18.03e6, 1, 1, 0.0, 0.05, 0.21, 1.0, 0.0), ...
            NaPulsedCool(80e-6, NaAxial8, 1, 0, 0.4, 0.14, 0.21), ...
            NaPulsedCool(80e-6, NaAxial7, 1, 0, 0.4, 0.14, 0.21), ...
            NaPulsedCool(25e-6, -17.2825e6, 0, 1, 0.0, 0.05, 0.21, 0.22, 0.0), ...
            NaPulsedCool(21e-6, -17.875e6, 0, 1, 0.0, 0.05, 0.21, 0.22, 0.0)};
NaCools2 = repmat(NaCools2, 1, 5);
% Axial 7+6, Radial2 2+1, Radial3 2+1
NaCools3 = {NaPulsedCool(80e-6, NaAxial7, 1, 0, 0.4, 0.14, 0.21), ...
            NaPulsedCool(80e-6, NaAxial6, 1, 0, 0.4, 0.14, 0.21), ...
            NaPulsedCool(25e-6, -17.6375e6, 1, 1, 0.0, 0.05, 0.21, 1.0, 0.0), ...
            NaPulsedCool(25e-6, -18.03e6, 1, 1, 0.0, 0.05, 0.21, 1.0, 0.0), ...
            NaPulsedCool(80e-6, NaAxial7, 1, 0, 0.4, 0.14, 0.21), ...
            NaPulsedCool(80e-6, NaAxial6, 1, 0, 0.4, 0.14, 0.21), ...
            NaPulsedCool(25e-6, -17.2825e6, 0, 1, 0.0, 0.05, 0.21, 0.22, 0.0), ...
            NaPulsedCool(21e-6, -17.875e6, 0, 1, 0, 0.05, 0.21, 0.22, 0.0)};
NaCools3 = repmat(NaCools3, 1, 6);
% Axial 6+5, Radial2 2+1, Radial3 2+1
NaCools4 = {NaPulsedCool(80e-6, NaAxial6, 1, 0, 0.4, 0.14, 0.21), ...
            NaPulsedCool(60e-6, NaAxial5, 1, 0, 0.4, 0.14, 0.21), ...
            NaPulsedCool(25e-6, -17.6375e6, 1, 1, 0.0, 0.05, 0.21, 1.0, 0.0), ...
            NaPulsedCool(25e-6, -18.03e6, 1, 1, 0.0, 0.05, 0.21, 1.0, 0.0), ...
            NaPulsedCool(80e-6, NaAxial6, 1, 0, 0.4, 0.14, 0.21), ...
            NaPulsedCool(60e-6, NaAxial5, 1, 0, 0.4, 0.14, 0.21), ...
            NaPulsedCool(25e-6, -17.2825e6, 0, 1, 0.0, 0.05, 0.21, 0.22, 0.0), ...
            NaPulsedCool(21e-6, -17.875e6, 0, 1, 0.0, 0.05, 0.21, 0.22, 0.0)};
NaCools4 = repmat(NaCools4, 1, 7);
% Axial 5+4, Radial2 1, Radial3 1
NaCools5 = {NaPulsedCool(90e-6, NaAxial5, 1, 0, 0.4, 0.00, 0.21, 0.0, 0.22), ...
            NaPulsedCool(38e-6, -18.03e6, 1, 1, 0.0, 0.05, 0.21, 1.0, 0.0), ...
            NaPulsedCool(75e-6, NaAxial4, 1, 0, 0.4, 0.00, 0.21, 0.0, 0.22), ...
            NaPulsedCool(25e-6, -18.03e6, 1, 1, 0.0, 0.05, 0.21, 1.0, 0.0), ...
            NaPulsedCool(90e-6, NaAxial5, 1, 0, 0.4, 0.00, 0.21, 0.0, 0.22), ...
            NaPulsedCool(43e-6, -17.875e6, 0, 1, 0.0, 0.05, 0.21, 0.22, 0.0), ...
            NaPulsedCool(75e-6, NaAxial4, 1, 0, 0.4, 0.00, 0.21, 0.0, 0.22), ...
            NaPulsedCool(28e-6, -17.875e6, 0, 1, 0.0, 0.05, 0.21, 0.22, 0.0)};
NaCools5 = repmat(NaCools5, 1, 7);
% Axial 4+3, Radial2 1, Radial3 1
NaCools6 = {NaPulsedCool(75e-6, NaAxial4, 1, 0, 0.4, 0.00, 0.21, 0.0, 0.22), ...
            NaPulsedCool(38e-6, -18.03e6, 1, 1, 0.0, 0.05, 0.21, 1.0, 0.0), ...
            NaPulsedCool(60e-6, NaAxial3, 1, 0, 0.4, 0.00, 0.21, 0.0, 0.22), ...
            NaPulsedCool(25e-6, -18.03e6, 1, 1, 0.0, 0.05, 0.21, 1.0, 0.0), ...
            NaPulsedCool(75e-6, NaAxial4, 1, 0, 0.4, 0.00, 0.21, 0.0, 0.22), ...
            NaPulsedCool(43e-6, -17.875e6, 0, 1, 0.0, 0.05, 0.21, 0.22, 0.0), ...
            NaPulsedCool(60e-6, NaAxial3, 1, 0, 0.4, 0.00, 0.21, 0.0, 0.22), ...
            NaPulsedCool(28e-6, -17.875e6, 0, 1, 0.0, 0.05, 0.21, 0.22, 0.0)};
NaCools6 = repmat(NaCools6, 1, 8);
% Axial 3+2, Radial2 1, Radial3 1
NaCools7 = {NaPulsedCool(60e-6, NaAxial3, 1, 0, 0.4, 0.00, 0.21, 0.0, 0.22), ...
            NaPulsedCool(38e-6, -18.03e6, 1, 1, 0.0, 0.05, 0.21, 1.0, 0.0), ...
            NaPulsedCool(60e-6, NaAxial2, 1, 0, 0.4, 0.00, 0.21, 0.0, 0.22), ...
            NaPulsedCool(25e-6, -18.03e6, 1, 1, 0.0, 0.05, 0.21, 1.0, 0.0), ...
            NaPulsedCool(60e-6, NaAxial3, 1, 0, 0.4, 0.00, 0.21, 0.0, 0.22), ...
            NaPulsedCool(43e-6, -17.875e6, 0, 1, 0.0, 0.05, 0.21, 0.22, 0.0), ...
            NaPulsedCool(60e-6, NaAxial2, 1, 0, 0.4, 0.00, 0.21, 0.0, 0.22), ...
            NaPulsedCool(28e-6, -17.875e6, 0, 1, 0.0, 0.05, 0.21, 0.22, 0.0)};
NaCools7 = repmat(NaCools7, 1, 10);
% Axial 2+1, Radial2 1, Radial3 1
NaCools81 = {NaPulsedCool(60e-6, NaAxial2, 1, 0, 0.4, 0.00, 0.21, 0.0, 0.22), ...
             NaPulsedCool(38e-6, -18.03e6, 1, 1, 0.0, 0.05, 0.21, 1.0, 0.0), ...
             NaPulsedCool(60e-6, NaAxial1, 1, 0, 0.4, 0.00, 0.21, 0.0, 0.22), ...
             NaPulsedCool(25e-6, -18.03e6, 1, 1, 0.0, 0.05, 0.21, 1.0, 0.0), ...
             NaPulsedCool(60e-6, NaAxial2, 1, 0, 0.4, 0.00, 0.21, 0.0, 0.22), ...
             NaPulsedCool(43e-6, -17.875e6, 0, 1, 0.0, 0.05, 0.21, 0.22, 0.0), ...
             NaPulsedCool(60e-6, NaAxial1, 1, 0, 0.4, 0.00, 0.21, 0.0, 0.22), ...
             NaPulsedCool(28e-6, -17.875e6, 0, 1, 0.0, 0.05, 0.21, 0.22, 0.0)};
NaCools8Axial = NaPulsedCool(100e-6, NaAxial1_2, 1, 0, 0.2, 0.0, 0.21, 0.0, 0.22);
NaCools8 = {NaPulsedCool(70e-6, NaAxial1_2, 1, 0, 0.2, 0.0, 0.21, 0.0, 0.22), ...
            NaCools8Axial, ...
            NaPulsedCool(21e-6, -17.875e6, 0, 1, 0.0, 0.05, 0.21, 0.22, 0.0), ...
            NaPulsedCool(70e-6, NaAxial1_2, 1, 0, 0.2, 0.0, 0.21, 0.0, 0.22), ...
            NaCools8Axial, ...
            NaPulsedCool(25e-6, -18.030e6, 1, 1, 0.0, 0.05, 0.21, 1.0, 0.0), ...
            NaPulsedCool(70e-6, NaAxial1_2, 1, 0, 0.2, 0.0, 0.21, 0.0, 0.22), ...
            NaCools8Axial, ...
            NaPulsedCool(43e-6, -17.875e6, 0, 1, 0.0, 0.05, 0.21, 0.22, 0.0), ...
            NaPulsedCool(70e-6, NaAxial1_2, 1, 0, 0.2, 0.0, 0.21, 0.0, 0.22), ...
            NaCools8Axial, ...
            NaPulsedCool(38e-6, -18.030e6, 1, 1, 0.0, 0.05, 0.21, 1.0, 0.0)};
NaCools8 = [repmat(NaCools81, 1, 10), repmat(NaCools8, 1, 40)];
NaCools = [NaCools1, NaCools2, NaCools3, NaCools4, ...
           NaCools5, NaCools6, NaCools7, NaCools6, NaCools7, NaCools8];
NaMaxCool = length(NaCools);
for i = 1:length(NaCools)
    if i > NaMaxCool
        break;
    end
    NaCools{i}.run(s, state);
end
if state.hasCool
    s.addStep(100e-6) ...
        .add('NaF1DP400/AMP', 0.32) ...
        .add('NaD1/AMP', 0.0) ...
        .add('NaOP/AMP', 0.25) ...
        .add('NaRaman1/AMP', 0) ...
        .add('NaRaman2/AMP', 0);
    s.addStep(5e-6) ...
        .add('NaF1DP400/AMP', 0) ...
        .add('NaOP/AMP', 0);
end
